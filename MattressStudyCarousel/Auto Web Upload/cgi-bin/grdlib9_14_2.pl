# ---------------------------------------------------------------------------
#     GRDLIB.PL
#
#      Ver: 9_14_2
# ---------------------------------------------------------------------------
# Lighthouse Studio - Web Surveying System
# Copyright Sawtooth Software, Inc. 1998-2022. All rights reserved.
# Provo, UT  USA  (801) 477-4700
#
# Any modification of this script will be considered violation of
# copyright (with the exception of the first line which can be
# modified to reflect the correct path to the Perl interpreter)
#
# Any use of this script or its code for purposes outside of
# the systems created by Sawtooth Software is prohibited.
# ---------------------------------------------------------------------------
 use strict; package grdlib9_14_2; our @ISA = qw(questionlib9_14_2); sub new { my ($__ecw) = @_; $__ecw->{'_vo'} = "grid"; bless($__ecw); return $__ecw; } sub _ve { my ($__edq) = @_; $__edq->SUPER::_ve(); my $__ecx = authlib9_14_2::_acy($__edq->{'_uf'}->{'_mw'}); my $__ecy = authlib9_14_2::_acy($__edq->{'_uf'}->{'_co'}); my @__ecz = (); my $__eda = $__edq->{'_uf'}; my $__edb = $__eda->{'_pv'}; my $__edc = $__eda->{'_pu'}; my $__edd = 0; my $__ede = 0; my $__edf = 0; my $__edg = ""; my $__edh = ""; my $__edi = ""; my $__edj = 0; my $__edk = 0; if (exists $__eda->{'_bt'}) { $__edq->{'_vo'} .= " cbcrating"; } if ($__edc eq "rows") { $__edk = 1; } if (($__ecx == 0 || @{$__ecx} == 0) || ($__ecy == 0 || @{$__ecy} == 0)) { $__edq->{'_uk'} = 1; } else { $__eda->{'_aqe'} = $__ecx; $__eda->{'_aqf'} = $__ecy; } if (!$authlib9_14_2::_amg && (not exists $__edq->{'_uk'})) { if ($__edk) { if ($__ecy && @{$__ecy} == 1) { my $__edl = authlib9_14_2::_acx($__eda->{'_co'}); if ($__edl && exists ($__edl->{'_jq'})) { $__ede = $__ecy->[0]; $__edf = $__ecx; $__edj = $__edq->_apt($__ecy->[0], $__ecx); $__edg = "_c"; $__edh = "_r"; } } } else { if ($__ecx && @{$__ecx} == 1) { my $__edl = authlib9_14_2::_acx($__eda->{'_mw'}); if ($__edl && exists ($__edl->{'_jq'})) { $__ede = $__ecx->[0]; $__edf = $__ecy; $__edj = $__edq->_apt($__ecx->[0], $__ecy); $__edg = "_r"; $__edh = "_c"; } } } if ($__edj) { if (exists $__ede->{'_jg'} && $__ede->{'_jg'}->{'_op'}) { push(@__ecz, [$__edq->{'_if'} . $__edg . $__ede->{'_pt'} . "_other", $__ede->{'_jg'}->{'_op'}]); } foreach my $__edm (@{$__edf}) { if (exists $__edm->{'_jg'} && $__edm->{'_jg'}->{'_op'}) { push(@__ecz, [$__edq->{'_if'} . $__edh . $__edm->{'_pt'} . "_other", $__edm->{'_jg'}->{'_op'}]); } my $__edd = $__edb->[$__edm->{'_pt'} - 1]; $__edi = ref($__edd); if ($__edi eq "RadioVar") { push (@__ecz, [$__edd->{'_if'}, $__ede->{'_pt'}]); } elsif ($__edi eq "CheckVar" || $__edi eq "RankVar") { if ($__edk) { push(@__ecz, [$__edd->{'_if'} . "_c" . $__ede->{'_pt'}, 1]); } elsif ($__edd->{'_if'} =~ m/(.+?)_(.+)$/mo) { my $__edn = $1; my $__edo = $2; push (@__ecz, [$__edn . "_r" . $__ede->{'_pt'} . "_" . $__edo, 1]); } } elsif ($__edi eq "ComboVar") { my $__edp = authlib9_14_2::_acy($__edd->{'_hj'}); if ($__edp) { if ($__edk) { push(@__ecz, [$__edd->{'_if'} . "_c" . $__ede->{'_pt'}, $__edp->[0]->{'_pt'}]); } elsif ($__edd->{'_if'} =~ m/(.+?)_(.+)$/mo) { my $__edn = $1; my $__edo = $2; push (@__ecz, [$__edn . "_r" . $__ede->{'_pt'} . "_" . $__edo, $__edp->[0]->{'_pt'}]); } } } elsif ($__edi eq "ConsumVar") { if ($__edk) { push(@__ecz, [$__edd->{'_if'} . "_c" . $__ede->{'_pt'}, $__edd->{'_dg'}]); } elsif ($__edd->{'_if'} =~ m/(.+?)_(.+)$/mo) { my $__edn = $1; my $__edo = $2; push (@__ecz, [$__edn . "_r" . $__ede->{'_pt'} . "_" . $__edo, $__edd->{'_dg'}]); } } } $__edq->{'_um'} = \@__ecz; } } } sub _apt { my ($__edz, $__eea, $__eeb) = @_; my $__edr = $__edz->{'_uf'}->{'_pv'}; my $__eds = 0; my $__edt = ""; my %__edu = ("RadioVar" => 1, "CheckVar" => 1, "ComboVar" => 1, "ConsumVar" => 1, "RankVar" => 1); my $__edv = 1; foreach my $__edw (@{$__eeb}) { if ($__edw->{'_jg'}) { unless ($__edw->{'_jg'}->{'_op'}) { $__edv = 0; } } } if ($__eea->{'_jg'}) { unless ($__eea->{'_jg'}->{'_op'}) { $__edv = 0; } } if ($__edv) { foreach $__eds (@{$__edr}) { $__edt = ref($__eds); if ($__edu{$__edt}) { if ($__eds->{'_ml'} || $__eds->{'_hx'}) { if ($__edt eq "ComboVar" || $__eds->{'_pj'} eq "combo") { my $__edx = authlib9_14_2::_acy($__eds->{'_hj'}); my $__edy = authlib9_14_2::_acx($__eds->{'_hj'}); unless ($__edx && @{$__edx} == 1 && $__edy && exists($__edy->{'_jq'})) { $__edv = 0; last; } } } else { $__edv = 0; last; } } else { $__edv = 0; last; } } } return $__edv; } sub _vf { my ($__eef) = @_; my $__eec = ""; my $__eed = ""; my $__eee = $__eef->{'_uf'}; if (exists $__eee->{'_fe'}) { $__eed = ciwlib9_14_2::_tk($__eee->{'_fe'}, 0, 0); if ($__eed) { $__eec .= "\n#" . $__eef->{'_if'} . "_div .grid_header_cell {" . $__eed . "}\n"; } } if (exists $__eee->{'_fd'}) { $__eed = ciwlib9_14_2::_tk($__eee->{'_fd'}, 0, 0); if ($__eed) { $__eec .= "\n#" . $__eef->{'_if'} . "_div .grid_footer_cell {" . $__eed . "}\n"; } } if (exists $__eee->{'_di'}) { $__eed = ciwlib9_14_2::_tk($__eee->{'_di'}, 0, 0); if ($__eed) { $__eec .= "\n#" . $__eef->{'_if'} . "_div .corner_label_text {" . $__eed . "}\n"; } } if (exists $__eee->{'_mv'}->{'_fk'}) { $__eed = ciwlib9_14_2::_tk($__eee->{'_mv'}, 0, 0); if ($__eed || exists $__eee->{'_mv'}->{'_gu'}) { $__eec .= "\n#" . $__eef->{'_if'} . "_div .row_label_cell .grid_options {" . $__eed; if (exists $__eee->{'_mv'}->{'_gu'}) { $__eec .= " vertical-align: " . $__eee->{'_mv'}->{'_gu'} . ";"; } $__eec .= "}\n"; } if (exists $__eee->{'_mv'}->{'_et'}) { if (exists $__eee->{'_mv'}->{'_et'}->{'_m'}) { $__eec .= "\n#" . $__eef->{'_if'} . "_div .row_label_cell textarea {" . ciwlib9_14_2::_tl($__eee->{'_mv'}->{'_et'}->{'_m'}) . "}\n"; } } } if (exists $__eee->{'_cl'}->{'_fk'}) { $__eed = ciwlib9_14_2::_tk($__eee->{'_cl'}, 0, 0); if ($__eed) { $__eec .= "\n#" . $__eef->{'_if'} . "_div .col_label_cell .grid_options { " . $__eed . " }\n"; } if (exists $__eee->{'_cl'}->{'_gu'}) { $__eec .= "\n#" . $__eef->{'_if'} . "_div.grid .col_label_cell { vertical-align: " . $__eee->{'_cl'}->{'_gu'} . "; }\n"; } if (exists $__eee->{'_cl'}->{'_et'}) { if (exists $__eee->{'_cl'}->{'_et'}->{'_m'}) { $__eec .= "\n#" . $__eef->{'_if'} . "_div .col_label_cell textarea {" . ciwlib9_14_2::_tl($__eee->{'_cl'}->{'_et'}->{'_m'}) . "}\n"; } } } if (exists $__eee->{'_q'}) { if (exists $__eee->{'_q'}->{'_ay'}) { $__eec .= "\n#" . $__eef->{'_if'} . "_div .alt_color1 {background-color: #" . $__eee->{'_q'}->{'_ay'} . ";}\n"; } if (exists $__eee->{'_q'}->{'_az'}) { $__eec .= "\n#" . $__eef->{'_if'} . "_div .alt_color2 {background-color: #" . $__eee->{'_q'}->{'_az'} . ";}\n"; } } if (exists $__eee->{'_bg'}) { $__eec .= "\n#" . $__eef->{'_if'} . "_div .inner_table td {border-width: " . $__eee->{'_bg'} . "px; border-style: solid;}\n"; } if (exists $__eee->{'_cc'}) { $__eec .= "\n#" . $__eef->{'_if'} . "_div .inner_table .row_label_cell {padding: " . $__eee->{'_cc'} . "px;}\n"; $__eec .= "\n#" . $__eef->{'_if'} . "_div .inner_table .col_label_cell {padding: " . $__eee->{'_cc'} . "px;}\n"; $__eec .= "\n#" . $__eef->{'_if'} . "_div .inner_table .corner_label_cell {padding: " . $__eee->{'_cc'} . "px;}\n"; $__eec .= "\n#" . $__eef->{'_if'} . "_div .inner_table .input_cell {padding: " . $__eee->{'_cc'} . "px;}\n"; } if (exists $__eee->{'_bd'}) { $__eec .= "\n#" . $__eef->{'_if'} . "_div .inner_table {" . ciwlib9_14_2::_tl($__eee->{'_bd'}) . "}\n"; } return $__eec; } sub _apu { my ($__ees, $__eet, $__eeu, $__eev, $__eew, $__eep, $__eex, $__eey, $__eez) = @_; my $__eeg = 0; my $__eeh = 0; my @__eei = (); my $__eej = 0; my $__eek = ""; my $__eel = 0; my $__eem = 0; if ($__ees) { $__eeg = @{$__ees}; } my $__een = 0; if (($__eev eq "RankVar") && ($__eet->{'_pj'} eq "combo")) { if (exists $__eet->{'_ho'}) { authlib9_14_2::_adt($__eet); if ($__eet->{'_ho'} < $__eew) { $__eew = $__eet->{'_ho'}; } } if ($__eeg > $__eew) { @{$__ees} = @{$__ees}[0 .. ($__eew - 1)]; $__eeg = @{$__ees}; } } if (exists($__eet->{'_ln'})) { $__een = 1; } $__eeh = 0; my $__eeo = ""; if ($__een) { my $__eep = 0; my $__eeq = 1; my $__eer = 0; $__eer = authlib9_14_2::_acl($__ees); $__eeh = authlib9_14_2::_acm($__eey, $__eeg, (($__eex + $__eep) * 17), $__eeq, $__eer); } else { @__eei = () x $__eeg; for ($__eej = 0; $__eej < $__eeg; $__eej++) { $__eei[$__eej] = $__eej; } $__eeh = \@__eei; } $__eek .= "<option value=\"\">"; if (exists($__eet->{'_dt'})) { $__eek .= $__eet->{'_dt'}; } $__eek .= "</option>"; for ($__eej = 0; $__eej < $__eeg; $__eej++) { $__eel = $__eeh->[$__eej]; $__eem = $__ees->[$__eel]; if (exists ($__eem->{'_jg'})) { if (exists($__eem->{'_jg'}->{'_op'})) { $__eeo .= "\n<input type=\"hidden\" name=\"" . $__eeu . "_" . $__eem->{'_pt'} . "_other" . "\" value=\"" . $__eem->{'_jg'}->{'_op'} . "\">\n"; } } $__eek .= "<option value=\"" . $__eem->{'_pt'} . "\""; if (exists $__eez->{'_ug'}) { if ($__eez->{'_ug'}->{$__eeu} == $__eem->{'_pt'}) { $__eek .= " selected"; } } $__eek .= " id=\"" . $__eeu . "_" . $__eem->{'_pt'} . "\">"; $__eek .= $__eem->{'_op'}; $__eek .= "</option>"; } return ($__eek, $__eeo); } sub _apv { my ($__efb, $__efc, $__efd) = @_; my $__efa; if ($__efc eq "RankVar") { if (exists $__efb->{'_ho'}) { authlib9_14_2::_adt($__efb); $__efa = length(int($__efb->{'_ho'})); } else { $__efa = $__efd; } } else { if (exists $__efb->{'_px'}) { $__efa = authlib9_14_2::_abi($__efb->{'_px'}); } } return $__efa; } sub _apw { my ($__efg, $__efh, $__efi, $__efj) = @_; my $__efe = ""; my $__eff = 0; $__efe = $__efg->{'_if'}; if ($__efj eq "rows") { $__efe = $__efg->{'_if'}; $__efe .= "_c" . $__efh; } else { $__efe =~ s/(_c.*)$/_r$__efh$1/; } return $__efe; } sub _apx { my ($__efm, $__efn) = @_; my $__efk = $__efm; my $__efl = $__efm; if ($__efn) { $__efl =~ s/_r\d+/_r\*/; $__efk =~ s/_r\d+/_r_total/; } else { $__efl =~ s/_c\d+/_c\*/; $__efk =~ s/_c\d+/_c_total/; } return $__efk, $__efl; } sub _apy { my ($__efp, $__efq, $__efr) = @_; my $__efo = ""; if ($__efr) { $__efo = $__efp . "_r" . $__efq->{'_pt'} . "_other"; } else { $__efo = $__efp . "_c" . $__efq->{'_pt'} . "_other"; } return $__efo; } sub _apz { my ($__efx, $__efy, $__efz, $__ega, $__egb, $__egc) = @_; my $__efs = $__efx->{'_op'}; my $__eft = ""; my $__efu = ""; if ($__efx->{'_jg'}) { my $__efv = $__efx->{'_jg'}; my $__efw = _apy($__efy, $__efx, $__efz); $__efs = "<label for=\"$__efw\">$__efs</label>"; if (exists($__efv->{'_op'})) { $__eft .= "&nbsp;<span class=\"other_text_input\"><input type=\"hidden\" name=\"" . $__efw . "\" value=\"" . $__efv->{'_op'} . "\"></span>&nbsp;"; } else { $__eft .= "&nbsp;" . ciwlib9_14_2::_ri($__efw, $__efv, $__egc, "", $__egb) . "&nbsp;"; } } return $__efs . $__eft; } sub _aqa { my ($__egj) = @_; my $__egd = ""; my $__ege = "left"; my $__egf = ""; my $__egg = ""; my $__egh = ""; my $__egi = ""; if (exists $__egj->{'_by'}) { $__egd = $__egj->{'_by'}; if (exists $__egj->{'_ca'}) { $__egf = "text-align: " . $__egj->{'_ca'} . ";" } if (exists $__egj->{'_bz'}) { if ($__egj->{'_bz'} eq "right") { $__egi = "<span class=\"grid_cell_text right_input_label\" style=\"$__egf\">$__egd</span>"; return ($__egh, $__egi); } } $__egh = "<span class=\"grid_cell_text left_input_label\" style=\"$__egf\">$__egd</span>"; } return ($__egh, $__egi); } sub _aqb { my ($__eho, $__ehp, $__ehq, $__ehr, $__ehs, $__eht, $__ehu, $__ehv, $__ehw, $__ehx, $__ehy, $__ehz, $__eia, $__eib) = @_; my $__egk = {}; my $__egl = ""; my %__egm = (); my @__egn = (); my @__ego = (); my @__egp = (); my $__egq = 0; my $__egr = ""; my $__egs = ""; my $__egt = ""; my $__egu = ""; my $__egv = 0; my $__egw = 0; my $__egx = ""; my $__egy = ""; my $__egz = ""; my $__eha = ""; my $__ehb = ""; my $__ehc = $__ehr->{'_if'} =~ m/(_c.*)$/; my $__ehd = ""; my $__ehe = ""; my $__ehf = scalar@{ $__eho }; my $__ehg = ""; my ($__eic, $__eid) = _aqa($__eib); for ($__egq = 0; $__egq < $__ehf; $__egq++) { $__egx = "input_row"; $__egv = $__ehp->[$__egq]; $__egt = $__eho->[$__egv]->{'_pt'}; $__egs = _apw($__ehr, $__egt, $__ehq, $__eia); $__egu = $__egs; $__ehb = ""; $__ehd = "mobile_grid_label"; if ($__ehz) { $__ehe = _apz($__eho->[$__egv], $__ehx, $__ehc, $__egv, $__ehy, $__ehw); } push @__egn, $__egt; if ($__ehq eq "RadioVar" || $__ehq eq "CheckVar") { $__egx .= " mobile_select clickable response_row"; } if ($__eho->[$__egv]->{'_jg'}) { $__egx .= " other_$__egv mobile_grid_other"; $__ehd .= " other_label"; $__egk->{'_vw'} = 1; push(@__egp, $__egv); } if (exists($__eho->[$__egv]->{'_in'})) { push @__ego, $__eho->[$__egv]->{'_pt'}; } $__egr .= "<div class=\"$__egx\" data-col=\"" . ($__egv + 1) . "\">\n"; if ($__ehq eq "RadioVar") { $__egu = $__ehr->{'_if'} . "_" . ($__egv + 1); $__egr .= "<div class=\"input_cell option_column\">$__eic" . ciwlib9_14_2::_tm($__ehr->{'_if'}, $__egt, 1, $__ehw) . "$__eid</div>"; $__egr .= "<div class=\"option_cell option_column\"><label class=\"$__ehd\" for=\"$__egu\" id=\"" . $__egu . "_label\"><span class=\"user_defined_label\"></span><span class=\"grid_options label_text\">$__ehe</span></label></div>\n"; } elsif ($__ehq eq "CheckVar") { $__egr .= "<div class=\"input_cell option_column\">$__eic" . ciwlib9_14_2::_tm($__egs, 1, 0, $__ehw) . "$__eid</div>"; $__egr .= "<div class=\"option_cell option_column\"><label class=\"$__ehd\" for=\"$__egu\" id=\"" . $__egu . "_label\"><span class=\"user_defined_label\"></span><span class=\"grid_options label_text\">$__ehe</span></label></div>\n"; } elsif ($__ehq eq "NumericVar" || $__ehq eq "ConsumVar" || (($__ehq eq "RankVar") && ($__ehr->{'_pj'} eq "numeric"))) { $__egw = _apv($__ehr, $__ehq, $__ehf); if (exists $__ehw->{'_ug'}) { $__egy = $__ehw->{'_ug'}->{$__egs}; } my $__ehh = "<div class=\"option_cell option_column $__ehd\"><span class=\"user_defined_label\"></span><span class=\"grid_options label_text\">$__ehe</span></div>"; my $__ehi = "<div class=\"input_cell option_column\">"; if (exists $authlib9_14_2::_akn{"hid_test_mode"}) { $__ehi .= ciwlib9_14_2::_td($__egs, 0, 1); } my $__ehj = "tel"; if (exists $__ehr->{'_dq'}) { $__ehj = "text"; } $__ehi .= "$__eic<input id=\"$__egu\" name=\"$__egs\" type=\"" . $__ehj . "\" class=\"numeric_input\" size=\"$__egw\" value=\"$__egy\">$__eid</div>"; if ($__ehq eq "NumericVar") { $__egr .= $__ehh; $__egr .= $__ehi; } else { $__egr .= $__ehi; $__egr .= $__ehh; } } elsif ($__ehq eq "ComboVar" || ($__ehq eq "RankVar" && ($__ehr->{'_pj'} eq "combo"))) { $__egr .= "<div id=\"" . $__egs . "_error\">\n"; $__egr .= "<div class=\"option_cell option_column $__ehd\"><span class=\"user_defined_label\"></span><span class=\"grid_options label_text\">$__ehe</span></div>\n"; $__egr .= "<div class=\"input_cell option_column\">"; if (exists $authlib9_14_2::_akn{"hid_test_mode"}) { $__egr .= ciwlib9_14_2::_td($__egs, 0, 1); } $__egr .= "$__eic<select id=\"$__egu\" name=\"$__egs\">\n"; my $__ehk = authlib9_14_2::_acy($__ehr->{'_hj'}); my ($__eie, $__eif) = _apu($__ehk, $__ehr, $__egs, $__ehq, $__ehf, $__egq, $__ehu, $__ehv, $__ehw); $__egr .= $__eie . $__eif; $__egr .= "\n</select>$__eid</div>\n"; $__egr .= "</div>\n"; } elsif ($__ehq eq "OpenEndVar") { my $__ehl = ""; my $__ehm = ""; if (exists $__ehr->{'_ge'}) { $__ehl .= "width:" . $__ehr->{'_ge'} . "px; "; } if (exists $__ehw->{'_ug'}) { $__ehm = $__ehw->{'_ug'}->{$__egs}; } $__egr .= "<div class=\"option_cell option_column $__ehd\"><span class=\"user_defined_label\"></span><span class=\"grid_options label_text\">$__ehe</span></div>\n"; $__egr .= "<div class=\"input_cell option_column\">"; if (exists $authlib9_14_2::_akn{"hid_test_mode"}) { $__egr .= ciwlib9_14_2::_td($__egs, 0, 1); } $__egr .= "$__eic"; if ($__ehr->{'_pj'} eq "free") { if (exists $__ehr->{'_gc'}) { $__ehl .= "height:" . $__ehr->{'_gc'} . "px;"; } $__ehm =~ s/\r\n/\n/g; $__egr .= "<textarea id=\"$__egu\" name=\"$__egs\" wrap=\"virtual\" class=\"text_input\" style=\"$__ehl\">$__ehm</textarea>\n"; } else { $__egw = $__ehr->{'_ho'}; $__egr .= "<input id=\"$__egu\" name=\"$__egs\" type=\"text\" class=\"text_input open_end_text_box\" maxlength=\"$__egw\" value=\"$__ehm\">"; } $__egr .= "$__eid</div>"; } $__egr .= "</div>\n"; if ($__egq == ($__ehf - 1) && (($__ehq eq "ConsumVar" || $__ehq eq "NumericVar") && $__ehs)) { my $__ehn = 0; $__ehd = "mobile_grid_label total_label"; $__egw = $__ehr->{'_px'}; ($__egs, $__eha) = _apx($__egs, $__ehc); $__egm{$__eha} = $__eha; $__egr .= "<div class=\"input_row\">\n"; if ($__ehz) { $__egr .= "<label class=\"$__ehd\" for=\"$__egs\">$__eht</label>$__eic"; } $__egr .= ciwlib9_14_2::_sk($__egs, $__egw); $__egr .= "$__eid</div>\n"; } } $__egk->{'_fv'} = $__egr; if (%__egm) { $__egk->{'_aqg'} = \%__egm; } if (@__egn) { $__egk->{'_aqh'} =\@__egn; } if (@__ego) { $__egk->{'_aqi'} = \@__ego; } if (@__egp) { $__egk->{'_aqj'} = \@__egp; } return $__egk; } sub _vr { my ($__ens, $__ent, $__enu, $__env, $__enw) = @_; my $__eig = $__ens->{'_if'}; my $__eih = $__ens->{'_uf'}; my $__eii = $__eih->{'_cn'}; my $__eij = $__eih->{'_pu'}; my $__eik = 0; my $__eil = ""; my $__eim = $__eih->{'_pv'}; my $__ein = 0; my $__eio = ""; my $__eip = ""; my $__eiq = 0; my $__eir = 0; my @__eis = (); my %__eit = (); my $__eiu = ""; if (exists $__eih->{'_fe'}) { $__eiu = $__eih->{'_fe'}; } my $__eiv = ""; if (exists $__eih->{'_fd'}) { $__eiv = $__eih->{'_fd'}; } my $__eiw = $__eih->{'_aqe'}; my $__eix = @{$__eiw}; my $__eiy = $__eih->{'_mv'}->{'_jx'}; my $__eiz = 0; if (exists($__eih->{'_mv'}->{'_ak'})) { $__eiz = 1; } my $__eja = 0; if (exists($__eih->{'_mv'}->{'_ln'})) { $__eja = 1; } my $__ejb = 0; if (exists($__eih->{'_cl'}->{'_ln'})) { $__ejb = 1; } my $__ejc = 0; if (exists($__eih->{'_mv'}->{'_fk'})) { $__ejc = 1; } my $__ejd = $__eih->{'_mv'}->{'_gu'}; my $__eje = 0; if ($__eij eq "rows") { $__eje = $__eih->{'_mv'}->{'_mw'}; } my $__ejf = ""; my $__ejg = ""; my @__ejh = (); my $__eji = $__eih->{'_aqf'}; my $__ejj = @{$__eji}; my $__ejk = $__eih->{'_cl'}->{'_jx'}; my $__ejl = 0; if (exists($__eih->{'_cl'}->{'_ak'})) { $__ejl = 1; } my $__ejm = $__eih->{'_cl'}->{'randmin'}; my $__ejn = $__eih->{'_cl'}->{'randmax'}; my $__ejo = 0; if (exists($__eih->{'_cl'}->{'_fk'})) { $__ejo = 1; } my $__ejp = 0; if ($__eij eq "cols") { $__ejp = $__eih->{'_cl'}->{'_co'}; } my $__ejq = ""; my $__ejr = ""; my $__ejs = ""; my @__ejt = (); my $__eju = ""; if (exists $__eih->{'_di'}) { $__eju = $__eih->{'_di'}; } my $__ejv = ""; my $__ejw = ""; my $__ejx = 0; my $__ejy = 0; my $__ejz = 0; my $__eka = 0; my $__ekb = ""; my $__ekc = ""; my $__ekd = ""; my $__eke = ""; my $__ekf = 0; my $__ekg = 0; my $__ekh = 0; my $__eki = 0; my @__ekj = (); my $__ekk = 0; my $__ekl = 0; my $__ekm = ""; my %__ekn = (); my $__eko = 0; my $__ekp = 0; my %__ekq = (); my $__ekr = 0; my $__eks = 0; my $__ekt = 0; my $__eku = 1; my $__ekv = 0; my $__ekw = 0; my $__ekx = ""; my $__eky = ""; my $__ekz = ""; my $__ela = 0; my $__elb = 0; my @__elc = (); my @__eld = (); $__ekk = _aqc($__eja, $__eiw, $__enu, $__ent, $__eix); $__ekh = _aqc($__ejb, $__eji, $__enu, ($__ent * 53), $__ejj); my $__ele = 0; if (exists $__eih->{'_mv'}->{'_eu'}) { $__ele = $__eih->{'_mv'}->{'_eu'}; if ($__ele) { $__ela = int($__ejj / $__ele); $__ejj += $__ela; $__ela++; } } my $__elf = 0; if (exists $__eih->{'_cl'}->{'_eu'}) { $__elf = $__eih->{'_cl'}->{'_eu'}; if ($__elf) { $__elb = int($__eix / $__elf); $__eix += int($__eix / $__elf); } } if (exists $__eih->{'_pg'}) { if ($__eij eq "rows") { if (_aqd($__eim, $__eiw)) { $__ejj++; $__ekp = 1; } } else { if (_aqd($__eim, $__eji)) { $__eix++; $__eko = 1; } } } my $__elg = 0; my $__elh = 0; my $__eli = 100; my $__elj = 0; my $__elk = $__ejj; if ($__ejc) { if (exists $__eih->{'_gv'}) { $__elg = $__eih->{'_gv'}; } else { $__elg = 20; } $__eli -= $__elg; if ($__ela) { $__elg = int($__elg / $__ela); $__elk -= ($__ela - 1); } } $__elh = int($__eli / $__elk); $__ekg = $__ejj; my $__ell = 0; if (!exists $__eih->{'_ii'} && authlib9_14_2::_aes()) { my @__elm = (); my $__eln = "mobile_grid"; my $__elo = 0; my $__elp = ''; my $__elq = ""; my $__elr = 0; my $__els = 0; my $__elt = 0; my $__elu = ""; my $__elv = ""; my $__elw = 0; my $__elx = $__ekp || $__eko; my $__ely = "Total"; my $__elz = 0; my $__ema = 0; my $__emb = 0; my $__emc = 0; my $__emd = 0; my $__eme = 0; my $__emf = "row_grid"; if (!($__eih->{'_pu'} eq '_mw')) { $__emf = "col_grid"; } if (exists $__eih->{'_pg'}) { $__ely = $__eih->{'_pg'}; } $__ekm .= "<div class=\"$__eln grid_body $__emf\">"; if ($__eij eq "rows") { $__elo = scalar @{ $__eiw }; } elsif ($__eij eq "cols") { $__elo = scalar @{ $__eji }; } my $__emg = 0; for($__ejx = 0; $__ejx < @{$__eiw}; $__ejx++) { $__emg = $__eiw->[$__ejx]; if (exists $__emg->{'_jg'}) { push @__elc, $__ejx; } } for($__ejx = 0; $__ejx < @{$__eji}; $__ejx++) { $__emg = $__eji->[$__ejx]; if (exists $__emg->{'_jg'}) { push @__eld, $__ejx; } } for ($__ejx = 0; $__ejx < $__elo; $__ejx++) { if ($__eij eq "rows") { $__elt = $__ekk->[$__ejx]; $__elp = $__eiw->[$__elt]; $__elr = $__eji; $__els = $__ekh; $__emd = $__eiw->[$__elt]->{'_pt'}; $__elw = $__ejj - $__ela + 1; $__elu = "mobile_grid_question row_label_cell"; $__elu .= " grid_r" . $__emd; $__elu .= " " . $__eig . "_r" . $__emd; $__ema = 1; $__emb = $__ejc; $__emc = $__ejo; $__eme = $__eje->[$__emd - 1]; } elsif ($__eij eq "cols") { $__elt = $__ekh->[$__ejx]; $__elp = $__eji->[$__elt]; $__emd = $__eji->[$__elt]->{'_pt'}; $__elr = $__eiw; $__els = $__ekk; $__elw = $__eix - $__elb + 1; $__elu = "mobile_grid_question col_label_cell "; $__elu .= " grid_c" . $__emd; $__elu .= " " . $__eig . "_c" . $__emd; $__emb = $__ejo; $__emc = $__ejc; $__eme = $__ejp->[$__emd - 1]; } push @__elm, $__emd; $__elz = $__elt + 1; $__elq = _apz($__elp, $__eig, $__ema, $__elt, 0, $__eih); $__ekm .= "<div class=\"mobile_grid_card alt_color1\" data-card_num=\"" . $__elz . "\">\n"; if ($__emb) { $__ekm .= "<div class=\"$__elu\">$__elq</div>\n"; } $__ein = $__eim->[$__emd - 1]; $__eio = ref($__ein); my $__emh = _aqb($__elr, $__els, $__eio, $__ein, $__elx, $__ely, $__ent, $__enu, $__eih, $__eig, $__elz, $__emc, $__eij, $__eme); $__elv = $__emh->{'_fv'}; if ($__eio eq "CheckVar") { $__eit{$__emd} = ""; } if (exists $__emh->{'_aqg'}) { %__ekn = (%__ekn, %{$__emh->{'_aqg'}}); } if (exists $__emh->{'_aqk'}) { %__ekq = (%__ekq, %{$__emh->{'_aqk'}}); } if (exists $__emh->{'_aqh'}) { if ($__eij eq "cols") { @__ejh = @{$__emh->{'_aqh'}}; @__ejt = @__elm; if (exists $__emh->{'_aqg'}) { $__ell = $__emh->{'_aqh'}; } } elsif ($__eij eq "rows") { @__ejt = @{$__emh->{'_aqh'}}; @__ejh = @__elm; if (exists $__emh->{'_aqg'}) { $__ell = $__emh->{'_aqh'}; } } } if (exists $__emh->{'_vw'}) { $__eik = 1; } if (exists $__emh->{'_aqi'}) { @__eis = @{$__emh->{'_aqi'}}; } my $__emi = $__eio eq "RadioVar" ? "role=\"radiogroup\"" : ""; $__ekm .= "<div class=\"mobile_grid_options\" " . $__emi . ">\n"; if ($__eiu) { $__ekm .= "<div class=\"grid_header_cell mobile_grid_header\">" . $__eiu->{'_op'} . "</div>"; } $__ekm .= $__elv; if ($__eiv) { $__ekm .= "<div class=\"grid_footer_cell mobile_grid_footer\">" . $__eiv->{'_op'} . "</div>"; } $__ekm .= "</div>\n"; $__ekm .= "</div>\n"; } $__ekm .= "</div>"; } else { $__ekm .= "<table role=\"table\" class=\"inner_table\" width=\"100%\""; if ($__eih->{'_be'}) { $__ekm .= " style=\"width: " . $__eih->{'_be'} . "px\""; } $__ekm .= ">"; if ($__eiu) { $__ekm .= "<tr>"; if ($__ejc) { $__ejw .= "<td width=\"" . $__elg . "%\">&nbsp;</td>"; } if ($__eiy eq "left") { $__ekm .= $__ejw; } $__ekm .= "<td class=\"grid_header_cell\" width=\"" . $__elh . "%\" colspan=\"" . $__ekg . "\">\n"; $__ekm .= "<div class=\"grid_header\">"; $__ekm .= $__eiu->{'_op'}; $__ekm .= "</div></td>"; if ($__eiy eq "right") { $__ekm .= $__ejw; } $__ekm .= "</tr>"; $__ejw = ""; } my $__emj = 0; if ($__ejo) { $__ejq .= "<tr class=\"column_header_row\">"; if ($__ejc) { $__ejv .= "<td class=\"corner_label_cell "; if ($__eii eq "rows") { if ($__ejl && $__eiz) { if ((($__eix % 2) == 0) && $__ejk eq "bottom") { $__ejv .= " alt_color2"; } else { $__ejv .= " alt_color1"; } } } else { if ($__eiz && $__ejl) { if ((($__ejj & 1) == 0) && $__eiy eq "right") { $__ejv .= " alt_color1"; } else { $__ejv .= " alt_color2"; } } } $__ejv .= "\" width=\"" . $__elg . "%\">"; if ($__eju) { $__ejv .= "<div class=\"corner_label_text\">" . $__eju->{'_op'} . "</div>"; } else { $__ejv .= "&nbsp;"; } $__ejv .= "</td>"; if ($__eiy eq "left") { $__ejq .= $__ejv; } } $__emj = 0; my $__emk = 0; my $__eml = 0; for ($__ejx = 0; $__ejx < $__ejj; $__ejx++) { $__eml = 0; if ($__ekp && (($__ejx + 1) == $__ejj)) { $__eml = 1; } if (($__ele > 0) && ($__emk == $__ele)) { if ($__ejx < $__ejj - 1) { $__ejq .= $__ejv; } $__emk = 0; next; } else { $__emk++; } $__ekv = $__ekh->[$__emj]; $__emj++; $__ejq .= "<td role=\"columnheader\" class=\"col_label_cell"; if ($__ejl) { if ($__eii eq "rows") { if ((($__eix & 1) == 0) && $__ejk eq "bottom") { $__ejq .= " alt_color2"; } else { $__ejq .= " alt_color1"; } } else { if ($__ejx & 1) { $__ejq .= " alt_color2"; } else { $__ejq .= " alt_color1"; } } } if ($__eml) { $__ejq .= " grid_totals_col_header"; } else { $__ejq .= " grid_c" . $__eji->[$__ekv]->{'_pt'}; $__ejq .= " " . $__eig . "_c" . $__eji->[$__ekv]->{'_pt'}; } $__ejq .= "\" width=\"" . $__elh . "%\"><div class=\"grid_options\""; if ($__eij eq "cols" && ref($__eim->[$__eji->[$__ekv]->{'_pt'} - 1]) eq "RadioVar") { my @__emm = (); foreach my $__emn (@{$__eiw}) { my $__emo = $__eig . "_c" . $__eji->[$__ekv]->{'_pt'} . "_" . $__emn->{'_pt'}; push (@__emm, $__emo); push (@__emm, $__emo . "_graphical"); } $__ejq .= " role=\"radiogroup\" aria-owns=\"" . join(" ", @__emm) . "\""; } $__ejq .= ">\n"; if ($__eml) { $__ejr = $__eih->{'_pg'}; } else { $__ejr = $__eji->[$__ekv]->{'_op'}; if (exists($__eji->[$__ekv]->{'_jg'})) { $__ekw = $__eji->[$__ekv]->{'_jg'}; $__ekx = $__eig . "_c" . $__eji->[$__ekv]->{'_pt'} . "_other"; $__ejr = "<label for=\"$__ekx\">$__ejr</label>"; if (exists($__ekw->{'_op'})) { $__ejr .= "<input type=\"hidden\" name=\"" . $__ekx . "\" value=\"" . $__ekw->{'_op'} . "\">"; } else { $__eik = 1; $__ejr .= ciwlib9_14_2::_ri($__ekx, $__ekw, $__eih, ""); } push (@__eld, $__ekv); } if (exists($__eji->[$__ekv]->{'_in'})) { if ($__eij eq "rows") { push(@__eis, $__eji->[$__ekv]->{'_pt'}); } } } if ($__ejr eq "") { $__ejr = "&nbsp;"; } $__ejq .= $__ejr; $__ejq .= "</div></td>"; } if ($__eiy eq "right") { $__ejq .= $__ejv; } $__ejq .= "</tr>"; } if ($__ejk eq "top") { $__ekm .= $__ejq; } if ($__elf) { $__ekz = $__ejq; $__ekz =~ s/<input(.*?)_other(.*?)>//ig; } my $__emp = 0; my $__emq = 0; my $__emr = 0; my $__emk = 0; my $__ems = 0; $__ell = 0; for ($__ejx = 0; $__ejx < $__eix; $__ejx++) { if (($__elf > 0) && ($__emq == $__elf)) { if ($__ejx < $__eix - 1) { $__ekm .= $__ekz; } $__emq = 0; next; } else { $__emq++; } if ($__eko && (($__ejx + 1) == $__eix)) { $__emr = 1; } else { $__ekv = $__ekk->[$__emp]; $__emp++; $__ekl = $__eiw->[$__ekv]->{'_pt'}; push (@__ejh, $__ekl); $__ekl -= 1; } if ($__emr) { $__ekm .= "<tr id=\"" . $__eig . "_totals_row\" class=\"grid_totals_row\">"; } else { my $__emi = ""; if ($__eij eq "rows" && ref($__eim->[$__eiw->[$__ekv]->{'_pt'} - 1]) eq "RadioVar") { $__emi = "role=\"radiogroup\""; } $__ekm .= "<tr id=\"" . $__eig . "_r" . ($__ekl + 1) . "_row\" class=\"body_row grid_row" . ($__ekl + 1) . "\" " . $__emi . ">"; } if ($__ejc) { $__ejf = "<td role=\"rowheader\" class=\"row_label_cell"; if ($__eiz) { if ($__eii eq "rows") { if ($__ejx % 2) { $__ejf .= " alt_color1"; } else { $__ejf .= " alt_color2"; } } else { if (($__eiy eq "right") && (($__ejj & 1) == 0)) { $__ejf .= " alt_color1"; } else { $__ejf .= " alt_color2"; } } } if (!$__emr) { $__ejf .= " grid_r" . ($__ekl + 1) . " " . $__eig . "_r" . ($__ekl + 1); } $__ejf .= "\" width=\"" . $__elg . "%\"><div class=\"grid_options\">\n"; if ($__emr) { $__ejr = $__eih->{'_pg'}; } else { $__ejr = $__eiw->[$__ekv]->{'_op'}; if (exists($__eiw->[$__ekv]->{'_jg'})) { $__ekw = $__eiw->[$__ekv]->{'_jg'}; $__ekx = $__eig . "_r" . $__eiw->[$__ekv]->{'_pt'} . "_other"; $__ejr = "<label for=\"$__ekx\">$__ejr</label>"; if (exists($__ekw->{'_op'})) { $__ejr .= "<input type=\"hidden\" name=\"" . $__ekx . "\" value=\"" . $__ekw->{'_op'} . "\">"; } else { $__eik = 1; $__ejr .= ciwlib9_14_2::_ri($__ekx, $__ekw, $__eih, ""); } push @__elc, $__ekv; } if (exists($__eiw->[$__ekv]->{'_in'})) { if ($__eij eq "cols") { push @__eis, $__eiw->[$__ekv]->{'_pt'}; } } } if ($__ejr eq "") { $__ejr = "&nbsp;"; } $__ejf .= $__ejr; $__ejf .= "</div></td>"; } if ($__eiy eq "left") { $__ekm .= $__ejf; } if ($__ele) { $__eky = $__ejf; $__eky =~ s/<input(.*?)_other(.*?)>//ig; } $__ems = 0; $__emk = 0; $__emj = 0; for ($__ejy = 0; $__ejy < $__ejj; $__ejy++) { if (($__ele > 0) && ($__emk == $__ele)) { if ($__ejy < $__ejj - 1) { $__ekm .= $__eky; } $__emk = 0; next; } else { $__emk++; } if ($__ekp && (($__ejy + 1) == $__ejj)) { $__ems = 1; } else { $__ekv = $__ekh->[$__emj]; $__emj++; $__eki = $__eji->[$__ekv]->{'_pt'}; if ($__ejx == 0) { push @__ejt, $__eki; } $__eki -= 1; } if ($__eij eq "rows") { $__eka = $__eje->[$__ekl]; $__ein = $__eim->[$__ekl]; $__eip = $__ein->{'_if'}; $__eiq = $__eki + 1; $__eip = $__eip . "_c" . $__eiq; } else { $__eka = $__ejp->[$__eki]; $__ein = $__eim->[$__eki]; $__eip = $__ein->{'_if'}; $__eiq = $__ekl + 1; $__eip =~ s/(_c.*)$/_r$__eiq$1/; } $__ekb = ""; $__ekc = "left"; $__ekd = ""; $__eke = ""; if (exists $__eka->{'_by'}) { $__ekb = "<span class=\"grid_cell_text\">" . $__eka->{'_by'} . "</span>"; } if (exists $__eka->{'_bz'}) { $__ekc = $__eka->{'_bz'}; } if (exists $__eka->{'_ca'}) { $__ekd = $__eka->{'_ca'}; } if (exists $__eka->{'_cb'}) { $__eke = $__eka->{'_cb'}; } $__ekm .= "<td class=\"input_cell"; $__eio = ref($__ein); if ($__eio eq "RadioVar" || $__eio eq "CheckVar") { $__ekm .= " clickable"; } if ($__eii eq "rows") { if ($__ejx & 1) { $__ekm .= " alt_color1"; } else { $__ekm .= " alt_color2"; } } else { if ($__ejy & 1) { $__ekm .= " alt_color2"; } else { $__ekm .= " alt_color1"; } } if ($__emr || $__ems) { $__ekm .= " grid_total_cell"; } else { $__ekm .= " grid_r" . ($__ekl + 1); $__ekm .= " grid_c" . ($__eki + 1); if ($__eij eq "rows") { $__ekm .= " " . $__eig . "_r" . ($__ekl + 1); } elsif ($__eij eq "cols") { $__ekm .= " " . $__eig . "_c" . ($__eki + 1); } } if ($__ekb) { $__ekr = 1; } else { $__ekr = 0; } if ($__ekr && ($__emr || $__ems)) { if (($__eio ne "ConsumVar") && ($__eio ne "NumericVar")) { $__ekr = 0; } } $__ekm .= "\" width=\"" . $__elh . "%\" nowrap"; if ($__ekd || $__eke) { $__ekm .= " style=\""; if ($__ekd) { $__ekm .= "text-align: " . $__ekd . ";"; } if ($__eke) { $__ekm .= "vertical-align: " . $__eke . ";"; } if ($authlib9_14_2::_amg && exists $authlib9_14_2::_akp->{'_ex'}) { if ($__ekd || $__eke) { $__ekm .= "background-position: "; if ($__ekd) { $__ekm .= $__ekd; } else { $__ekm .= "center"; } if ($__eke) { $__ekm .= " " . $__eke; } else { $__ekm .= " center"; } $__ekm .= ";"; } } $__ekm .= "\""; } $__ekm .= ">"; if (exists $authlib9_14_2::_akn{"hid_test_mode"}) { if (!$__emr && !$__ems) { if ($__eio ne "RadioVar" && $__eio ne "CheckVar") { $__ekm .= ciwlib9_14_2::_td($__eip, 0, 1); } } } if ($__ekr && exists $authlib9_14_2::_akp->{'_ex'}) { $__ekm .= "<table class=\"grid_cell_label_table\""; if ($__ekd) { $__ekm .= " style=\"" . ciwlib9_14_2::_tl($__ekd) . "\""; } $__ekm .= "><tr>"; } if (($__ekc eq "left") && $__ekr) { if (exists $authlib9_14_2::_akp->{'_ex'}) { $__ekm .= "<td>" . $__ekb . "</td>"; } else { $__ekm .= $__ekb; } } if ($__ekr && exists $authlib9_14_2::_akp->{'_ex'}) { $__ekm .= "<td class=\"input_cell\">"; } if ($__emr || $__ems) { if ($__eio eq "ConsumVar" || $__eio eq "NumericVar") { my $__emt = $__eip; if ($__ems) { $__emt =~ s/_c\d+/_c\*/; $__eip =~ s/_c\d+/_c_total/; $__ell = \@__ejt; $__ekq{$__eki + 1} = $__eki + 1; $__ekn{$__emt} = $__emt; } else { $__emt =~ s/_r\d+/_r\*/; $__eip =~ s/_r\d+/_r_total/; $__ell = \@__ejh; $__ekn{$__emt} = $__emt; } $__eir = $__ein->{'_px'}; $__ekm .= ciwlib9_14_2::_sk($__eip, $__eir); if (exists $__eih->{'_ug'}) { my $__emu = $__eih->{'_ug'}->{$__eip}; $__ekm =~ s/(id\s*=\s*"$__eip")/$1 value="$__emu"/mi; } } else { $__ekm .= "&nbsp;"; } } elsif (($__eio eq "ComboVar") || (($__eio eq "RankVar") && ($__ein->{'_pj'} eq "combo"))) { my $__emv = 0; my $__emw = authlib9_14_2::_acy($__ein->{'_hj'}); my $__emx = 0; my $__emy = 0; if ($__emw) { $__emy = @{$__emw}; } my $__emz = 0; if (($__eio eq "RankVar") && ($__ein->{'_pj'} eq "combo")) { my $__ena = 0; if ($__eij eq "rows") { $__ena = @{$__eji}; } else { $__ena = @{$__eiw}; } if (exists $__ein->{'_ho'}) { authlib9_14_2::_adt($__ein); if ($__ein->{'_ho'} < $__ena) { $__ena = $__ein->{'_ho'}; } } if ($__emy > $__ena) { @{$__emw} = @{$__emw}[0 .. ($__ena - 1)]; $__emy = @{$__emw}; } } if (exists($__ein->{'_ln'})) { $__emz = 1; } my $__enb = 0; my $__enc = ""; if ($__emz) { my $__end = 0; my $__ene = 1; my $__enf = 0; $__enf = authlib9_14_2::_acl($__emw); if ($__eij eq "rows") { $__end = $__ekl; } else { $__end = $__eki; } $__enb = authlib9_14_2::_acm($__enu, $__emy, (($__ent + $__end) * 17), $__ene, $__enf); } else { @__ekj = () x $__emy; for ($__ejz = 0; $__ejz < $__emy; $__ejz++) { $__ekj[$__ejz] = $__ejz; } $__enb = \@__ekj; } $__ekm .= "<div id=\"" . $__eip . "_error\">\n"; $__ekm .= "<select name=\"" . $__eip . "\" id=\"" . $__eip . "\">"; $__ekm .= "<option value=\"\">"; if (exists($__ein->{'_dt'})) { $__ekm .= $__ein->{'_dt'}; } $__ekm .= "</option>"; for ($__ejz = 0; $__ejz < $__emy; $__ejz++) { $__emv = $__enb->[$__ejz]; $__emx = $__emw->[$__emv]; if (exists ($__emx->{'_jg'})) { if (exists($__emx->{'_jg'}->{'_op'})) { $__enc .= "\n<input type=\"hidden\" name=\"" . $__eip . "_" . $__emx->{'_pt'} . "_other" . "\" value=\"" . $__emx->{'_jg'}->{'_op'} . "\">\n"; } } $__ekm .= "<option value=\"" . $__emx->{'_pt'} . "\""; if (exists $__eih->{'_ug'}) { if ($__eih->{'_ug'}->{$__eip} == $__emx->{'_pt'}) { $__ekm .= " selected"; } } $__ekm .= " id=\"" . $__eip . "_" . $__emx->{'_pt'} . "\">"; $__ekm .= $__emx->{'_op'}; $__ekm .= "</option>"; } $__ekm .= "</select></div>\n" . $__enc . "\n"; } elsif ($__eio eq "OpenEndVar") { if ($__ein->{'_pj'} eq "free") { $__ekm .= "<textarea name=\"" . $__eip . "\" wrap=\"virtual\" id=\"" . $__eip . "\""; if (exists $__ein->{'_ge'} || exists $__ein->{'_gc'} || $__ekd) { $__ekm .= " style=\""; if (exists $__ein->{'_ge'}) { $__ekm .= "width:" . $__ein->{'_ge'} . "px;"; } if (exists $__ein->{'_gc'}) { $__ekm .= "height:" . $__ein->{'_gc'} . "px;"; } if ($__ekd) { $__ekm .= ciwlib9_14_2::_tl($__ekd); } $__ekm .= "\""; } $__ekm .= ">"; if (exists $__eih->{'_ug'}) { my $__eng = $__eih->{'_ug'}->{$__eip}; $__eng =~ s/\r\n/\n/g; $__ekm .= $__eng; } $__ekm .= "</textarea>"; } else { $__eir = $__ein->{'_ho'}; $__ekm .= "<input name=\"" . $__eip . "\" class=\"open_end_text_box text_input\" type=\"text\" maxlength=\"" . $__eir . "\""; if (exists $__ein->{'_ge'}) { $__ekm .= " style=\"width: " . $__ein->{'_ge'} . "px;\""; } if (exists $__eih->{'_ug'}) { $__ekm .= " value=\"" . $__eih->{'_ug'}->{$__eip} . "\""; } $__ekm .= " id=\"" . $__eip . "\">"; } } elsif (($__eio eq "NumericVar") || ($__eio eq "ConsumVar") || (($__eio eq "RankVar") && ($__ein->{'_pj'} eq "numeric"))) { if ($__eio eq "RankVar") { if (exists $__ein->{'_ho'}) { authlib9_14_2::_adt($__ein); $__eir = length(int($__ein->{'_ho'})); } else { if ($__eij eq "rows") { $__eir = length(@{$__eji}); $__ein->{'_aql'} = @{$__eji} + 0; } else { $__eir = length(@{$__eiw}); $__ein->{'_aql'} = @{$__eiw} + 0; } } } else { if (exists $__ein->{'_px'}) { $__eir = authlib9_14_2::_abi($__ein->{'_px'}); } } my $__enh = "tel"; if (exists $__ein->{'_dq'}) { $__enh = "text"; } $__ekm .= "<input name=\"" . $__eip . "\" type=\"" . $__enh . "\" class=\"numeric_input\""; if ($__eir) { $__ekm .= " size=\"" . $__eir . "\""; } if (exists $__eih->{'_ug'}) { $__ekm .= " value=\"" . $__eih->{'_ug'}->{$__eip} . "\""; } $__ekm .= " id=\"" . $__eip . "\">"; } elsif ($__eio eq "CheckVar") { $__ekm .= ciwlib9_14_2::_tm($__eip, 1, 0, $__eih); if ($__eij eq "rows") { $__eit{$__ekl + 1} = ""; } else { $__eit{$__eki + 1} = ""; } } elsif ($__eio eq "RadioVar") { $__ekm .= ciwlib9_14_2::_tm($__ein->{'_if'}, $__eiq, 1, $__eih); } if ($__ekr && exists $authlib9_14_2::_akp->{'_ex'}) { $__ekm .= "</td>"; } if (($__ekc eq "right") && $__ekr) { if ($__ekr && exists $authlib9_14_2::_akp->{'_ex'}) { $__ekm .= "<td>" . $__ekb . "</td>"; } else { $__ekm .= $__ekb; } } if ($__ekr && exists $authlib9_14_2::_akp->{'_ex'}) { $__ekm .= "</tr></table>"; } $__ekm .= "</td>"; } if ($__eiy eq "right") { $__ekm .= $__ejf; } $__ekm .= "</tr>"; } if ($__ejk eq "bottom") { $__ekm .= $__ejq; } if ($__eiv) { $__ekm .= "<tr>"; if ($__ejc) { $__ejw .= "<td width=\"" . $__elg . "%\">&nbsp;</td>"; } if ($__eiy eq "left") { $__ekm .= $__ejw; } $__ekm .= "<td class=\"grid_footer_cell\" width=\"" . $__elh . "%\" colspan=\"" . $__ekg . "\">\n"; $__ekm .= "<div class=\"grid_footer\">"; $__ekm .= $__eiv->{'_op'}; $__ekm .= "</div></td>"; if ($__eiy eq "right") { $__ekm .= $__ejw; } $__ekm .= "</tr>"; } $__ekm .= "</table>"; } if ($__ell && authlib9_14_2::_aet()) { $__ekm .= ciwlib9_14_2::_si($__eig, $__ell, \%__ekn, "_total"); } $__ejg = join(",", @__ejh); $__ejs = join(",", @__ejt); $__ekm .= "\n<input type=\"hidden\" name=\"hid_row_list_" . $__eig . "\" value=\"" . $__ejg . "\">\n"; $__ekm .= "\n<input type=\"hidden\" name=\"hid_col_list_" . $__eig . "\" value=\"" . $__ejs . "\">\n"; my $__eni = join(",", @__eis); if ($__eni) { $__ekm .= "\n<input type=\"hidden\" name=\"hid_noneabove_" . $__eig . "\" value=\"" . $__eni . "\">\n"; if ($__env) { my @__enj = sort {$a <=> $b} keys %__eit; my $__enk = ""; $__ekm .= "\n\n"; $__ekm .= "<script type=\"text/javascript\">\n"; my $__enl = ""; my $__enm = ""; for ($__ejx = 0; $__ejx < @__enj; $__ejx++) { $__enl = ""; $__enm = ""; $__enl .= "SSI_List_EventSetup("; if ($__eij eq "rows") { $__enm = $__eig . "_r" . $__enj[$__ejx] . "_c*"; $__enl .= "\"" . $__enm . "\", [" . $__ejs . "], "; } else { $__enm = $__eig . "_r*_c" . $__enj[$__ejx]; $__enl .= "\"" . $__enm . "\", [" . $__ejg . "], "; } $__enl .= "[" . $__eni . "]);\n"; $__ekm .= $__enl; } $__ekm .= "\n</script>\n"; $__ekm .= "\n\n"; } } if ($authlib9_14_2::_ajg) { $__ekm .= "<!--LoadTestMode: <question><name>$__eig</name><type>grid</type>"; $__ekm .= "<rowindices>$__ejg</rowindices>"; $__ekm .= "<colindices>$__ejs</colindices>"; $__ekm .= "<questdirection>$__eij</questdirection>"; if (@__elc > 0) { $__ekm .= "<rowotherindices>"; my $__enn = $__eiw; foreach my $__ejx (@__elc) { $__ekm .= "<otherspecify><index>" . $__enn->[$__ejx]->{'_pt'} . "</index>"; $__ekm .= "<min>" . $__enn->[$__ejx]->{'_jg'}->{'_hx'} . "</min>"; $__ekm .= "<max>" . $__enn->[$__ejx]->{'_jg'}->{'_ho'} . "</max>"; if (exists $__enn->[$__ejx]->{'_jg'}->{'_ic'}) { $__ekm .= "<multiline>" . $__enn->[$__ejx]->{'_jg'}->{'_ic'} . "</multiline>"; } $__ekm .= "</otherspecify>"; } $__ekm .= "</rowotherindices>"; } if (@__eld > 0) { $__ekm .= "<colotherindices>"; my $__enn = $__eji; foreach my $__ejx (@__eld) { $__ekm .= "<otherspecify><index>" . $__enn->[$__ejx]->{'_pt'} . "</index>"; $__ekm .= "<min>" . $__enn->[$__ejx]->{'_jg'}->{'_hx'} . "</min>"; $__ekm .= "<max>" . $__enn->[$__ejx]->{'_jg'}->{'_ho'} . "</max>"; if (exists $__enn->[$__ejx]->{'_jg'}->{'_ic'}) { $__ekm .= "<multiline>" . $__enn->[$__ejx]->{'_jg'}->{'_ic'} . "</multiline>"; } $__ekm .= "</otherspecify>"; } $__ekm .= "</colotherindices>"; } $__ekm .= "<vars>"; my $__eno = 0; if ($__eij eq "rows") { $__eno = \@__ejh; } else { $__eno = \@__ejt; } my $__enp = @{$__eno}; for ($__ejx = 0; $__ejx < $__enp; $__ejx++) { $__ekm .= "<var>"; $__ein = $__eim->[$__eno->[$__ejx] - 1]; $__eio = ref($__ein); $__ekm .= "<type>$__eio</type><name>" . $__ein->{'_if'} . "</name>"; if ($__eio eq "RadioVar") { $__ekm .= "<required>" . (exists $__ein->{'_ml'} ? "true" : "false") . "</required>"; } elsif ($__eio eq "ComboVar") { $__ekm .= "<indices>"; my $__enq = authlib9_14_2::_acy($__ein->{'_hj'}); if ($__enq) { $__ekm .= join(",", map {$_->{'_pt'}} @{$__enq}); } $__ekm .= "</indices>"; $__ekm .= "<required>" . (exists $__ein->{'_ml'} ? "true" : "false") . "</required>"; } elsif ($__eio eq "NumericVar") { $__ekm .= "<min>" . $__ein->{'_hx'} . "</min><max>" . $__ein->{'_ho'} . "</max>"; $__ekm .= "<required>" . (exists $__ein->{'_ml'} ? "true" : "false") . "</required>"; $__ekm .= "<decimal>" . (exists $__ein->{'_dq'} ? "true" : "false") . "</decimal>"; if (exists $__ein->{'_ie'}) { $__ekm .= "<na>" . $__ein->{'_ie'} . "</na>"; } } elsif ($__eio eq "OpenEndVar") { $__ekm .= "<min>" . $__ein->{'_hx'} . "</min><max>" . $__ein->{'_ho'} . "</max>"; $__ekm .= "<type>" . $__ein->{'_pj'} . "</type>"; $__ekm .= "<required>" . (exists $__ein->{'_ml'} ? "true" : "false") . "</required>"; } elsif ($__eio eq "CheckVar") { $__ekm .= "<min>" . $__ein->{'_hx'} . "</min><max>" . $__ein->{'_ho'} . "</max>"; $__ekm .= "<exclusiveindices>$__eni</exclusiveindices>"; } elsif ($__eio eq "ConsumVar") { $__ekm .= "<min>" . $__ein->{'_hx'} . "</min><max>" . $__ein->{'_ho'} . "</max>"; $__ekm .= "<required>" . (exists $__ein->{'_ml'} ? "true" : "false") . "</required>"; $__ekm .= "<consum>" . $__ein->{'_dg'} . "</consum>"; $__ekm .= "<decimal>" . (exists $__ein->{'_dq'} ? "true" : "false") . "</decimal>"; $__ekm .= "<wholereq>" . (exists $__ein->{'_pw'} ? "true" : "false") . "</wholereq>"; } elsif ($__eio eq "RankVar") { if ($__ein->{'_pj'} eq "combo") { $__ekm .= "<subtype>combo</subtype><options>"; my $__enq = authlib9_14_2::_acy($__ein->{'_hj'}); if ($__enq) { $__ekm .= join(",", map {$_->{'_pt'}} @{$__enq}) } $__ekm .= "</options>"; } else { $__ekm .= "<subtype>numeric</subtype>"; } $__ekm .= "<required>" . (exists $__ein->{'_ml'} ? "true" : "false") . "</required>"; if (exists $__ein->{'_ho'}) { $__ekm .= "<max>" . $__ein->{'_ho'} . "</max>"; } if (exists $__ein->{'_hx'}) { $__ekm .= "<min>" . $__ein->{'_hx'} . "</min>"; } } $__ekm .= "</var>"; } $__ekm .= "</vars></question>"; $__ekm .= "-->"; } my %__enr = (); $__enr{'_aqm'} = \@__ejh; $__enr{'_aqn'} = \@__ejt; $__enr{'_aqo'} = $__eni; if ($__eik) { $__enr{'_vw'} = $__eik; } $__ens->{'_vy'} = \%__enr; return $__ekm; } sub _vs { my ($__eoa, $__eob, $__eoc, $__eod) = @_; my $__enx = $__eoa->{'_vy'}; my $__eny = $__eoa->{'_if'}; ciwlib9_14_2::_st($__eny, authlib9_14_2::_ack($__eoa->{'_uf'}, 0, $__enx->{'_aqm'}, $__enx->{'_aqn'}), $__eoc, $__eob, $__eod, $__enx->{'_aqo'}, 0); if (exists $__enx->{'_vw'}) { my $__enz = "SSI_Grid_Other(\"" . $__eny . "\", "; $__enz .= "[" . join(",", @{$__enx->{'_aqm'}}) . "], "; $__enz .= "[" . join(",", @{$__enx->{'_aqn'}}) . "], " . $__eod . ")"; push @{$__eob}, ($__enz); $__eoc->{'_uy'} = 1; $__eoc->{'_aqp'} = 1; } } sub _aqc { my ($__eom, $__eon, $__eoo, $__eop, $__eoq) = @_; my $__eoe = 0; my $__eof = 0; my $__eog = 0; my $__eoh = 0; my $__eoi = 0; my @__eoj = (); my $__eok = 0; my $__eol = 0; if ($__eom) { $__eok = 1; $__eol = authlib9_14_2::_acl($__eon); } if ($__eoq < $__eol) { $__eol = $__eoq; } if ($__eok < $__eol) { $__eoi = authlib9_14_2::_acm($__eoo, $__eoq, $__eop, $__eok, $__eol); } else { for ($__eoh = 0; $__eoh < $__eoq; $__eoh++) { push @__eoj, $__eoh; } $__eoi = \@__eoj; } return $__eoi; } sub _aqd { my ($__eou, $__eov) = @_; my $__eor = 0; my $__eos = 0; my $__eot = ""; for ($__eor = 0; $__eor < @{$__eov}; $__eor++) { $__eot = ref($__eou->[$__eov->[$__eor]->{'_pt'} - 1]); if ($__eot eq "ConsumVar" || $__eot eq "NumericVar") { $__eos = 1; last; } } return $__eos; } return 1; 
